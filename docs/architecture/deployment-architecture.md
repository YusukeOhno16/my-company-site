# デプロイメントアーキテクチャ

このドキュメントでは、システムのデプロイメントアーキテクチャについて説明します。

## 1. デプロイメント環境

### 1.1 開発環境
- **ローカル開発サーバー**: `npm run dev`
- **テスト環境**: `npm test`
- **リント**: `npm run lint`
- **ビルド**: `npm run build`

### 1.2 本番環境
- **ホスティングプラットフォーム**: Vercel
- **デプロイメント方法**: GitHub連携による自動デプロイ
- **ブランチ戦略**: mainブランチへのマージで自動デプロイ

## 2. CI/CDパイプライン

### 2.1 継続的インテグレーション (CI)
- **プラットフォーム**: GitHub Actions
- **トリガー**: プルリクエスト作成/更新時
- **ステップ**:
  1. 依存関係のインストール
  2. リントチェック
  3. ビルド
  4. テスト実行

### 2.2 継続的デプロイメント (CD)
- **プラットフォーム**: Vercel
- **トリガー**: mainブランチへのマージ
- **ステップ**:
  1. ソースコードのクローン
  2. 依存関係のインストール
  3. ビルド
  4. デプロイ

## 3. デプロイメントフロー

### 3.1 開発からデプロイメントまでのフロー
```
開発者 → 機能ブランチ → プルリクエスト → CI → コードレビュー → マージ → CD → 本番環境
```

### 3.2 デプロイメントプロセス
1. 開発者が機能ブランチで開発
2. プルリクエストを作成
3. CIが自動的に実行され、コードの品質をチェック
4. コードレビュー実施
5. プルリクエストをmainブランチにマージ
6. Vercelが自動的にデプロイメントを実行
7. デプロイメント完了後、プレビューURLが生成される

## 4. 環境変数管理

### 4.1 開発環境
- `.env.local`ファイルで環境変数を管理
- `.gitignore`に追加し、リポジトリにコミットされないように保護

### 4.2 本番環境
- Vercel管理画面で環境変数を設定
- GitHub Secretsを使用してCI/CDパイプラインでも利用可能

### 4.3 環境変数の種類
- **SMTP_HOST**: SMTPサーバーのホスト名
- **SMTP_PORT**: SMTPサーバーのポート番号
- **SMTP_USER**: SMTPユーザー名
- **SMTP_PASSWORD**: SMTPパスワード
- **MAIL_FROM**: 送信元メールアドレス

## 5. デプロイメントの監視と管理

### 5.1 デプロイメントの監視
- Vercelダッシュボードでデプロイメント状況を監視
- デプロイメント履歴の確認
- ビルドログの確認

### 5.2 ロールバック戦略
- Vercelダッシュボードから以前のデプロイメントに戻す
- 緊急時のホットフィックスブランチの作成

## 6. パフォーマンス最適化

### 6.1 ビルド最適化
- Next.jsの自動最適化機能の活用
- 画像の最適化
- コードの分割

### 6.2 配信最適化
- Vercelのグローバルエッジネットワークの活用
- キャッシュ戦略の実装

## 更新履歴

| 日付 | バージョン | 更新者 | 内容 |
|------|------------|--------|------|
| 2025-05-29 | 0.1 | Devin | 初期ドキュメント作成 |
