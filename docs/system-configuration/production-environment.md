# 本番環境設定

このドキュメントでは、本番環境の設定方法について説明します。

## 1. デプロイメントプラットフォーム

### 1.1 Vercelプラットフォーム
- **概要**: Vercelは、Next.jsアプリケーションのデプロイに最適化されたプラットフォームです。
- **特徴**: 
  - グローバルCDN
  - 自動スケーリング
  - SSL証明書の自動管理
  - 継続的デプロイメント

### 1.2 Vercelアカウント設定
1. [Vercel](https://vercel.com/)にアクセスし、アカウントを作成
2. GitHubアカウントと連携
3. リポジトリをインポート

## 2. デプロイメント設定

### 2.1 プロジェクト設定
- **フレームワークプリセット**: Next.js
- **ビルドコマンド**: `npm run build`
- **出力ディレクトリ**: `.next`
- **インストールコマンド**: `npm install`

### 2.2 環境変数設定
Vercel管理画面から以下の環境変数を設定します。

- **SMTP_HOST**: SMTPサーバーのホスト名
- **SMTP_PORT**: SMTPサーバーのポート番号
- **SMTP_USER**: SMTPユーザー名
- **SMTP_PASSWORD**: SMTPパスワード
- **MAIL_FROM**: 送信元メールアドレス

### 2.3 ドメイン設定
1. Vercel管理画面から「Domains」セクションにアクセス
2. カスタムドメインを追加
3. DNSレコードを設定
4. SSL証明書の発行を確認

## 3. デプロイメント方法

### 3.1 自動デプロイメント
- GitHubリポジトリのmainブランチへのプッシュで自動的にデプロイされます。
- プルリクエストごとにプレビューデプロイメントが作成されます。

### 3.2 手動デプロイメント
```bash
# Vercel CLIのインストール
npm i -g vercel

# ログイン
vercel login

# デプロイ
vercel
```

## 4. 本番環境の監視

### 4.1 パフォーマンスモニタリング
- Vercelアナリティクスを使用したパフォーマンス監視
- Web Vitalsの追跡
- エラーレポート

### 4.2 ログ管理
- Vercelログダッシュボードでのログ確認
- 必要に応じて外部ログサービスとの連携

## 5. スケーリングと最適化

### 5.1 自動スケーリング
- Vercelは負荷に応じて自動的にスケーリングします。
- 特別な設定は不要です。

### 5.2 パフォーマンス最適化
- 画像最適化の有効化
- キャッシュ戦略の実装
- コード分割の活用

## 6. バックアップと復旧

### 6.1 デプロイメントバックアップ
- Vercelは各デプロイメントの履歴を保持します。
- 必要に応じて以前のデプロイメントに戻すことができます。

### 6.2 障害復旧計画
- 重大な問題が発生した場合は、以前の安定したデプロイメントにロールバックします。
- 定期的なデプロイメントテストを実施します。

## 更新履歴

| 日付 | バージョン | 更新者 | 内容 |
|------|------------|--------|------|
| 2025-05-29 | 0.1 | Devin | 初期ドキュメント作成 |
